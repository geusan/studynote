데이터베이스 튜터링
===================

2017.09.28 두번째

> 이론에 질문이 있으면 받기로 결정


오늘의 할일 게시판 DB 만들기
- 갑자기 융소전자에 의뢰가 들어왔다. 융소동아리의 운영을 위한 게시판을 만들어달라고 한다. 게시판의 목적은 동아리원 내의 친목도모이며, 이를 위해서 서로 속깊은 이야기를 허심탄회하게 나눌 수 있어야한다. 게시판의 기능은 크게 회원인증(로그인, 회원가입), 글쓰기, 댓글쓰기의 기능을 가지고 있으며, 각 기능과 요소들에 대한 특성은 다음과 같다.


1. 회원은 이름, 학번, 학년, 전공, 생년월일을 가지고 있으며 글쓰기, 댓글쓰기의 기능을 사용할수 있다.
2. 각 게시물에는 제목과 내용, 글쓴이, 글쓴 날짜가 필요하다.
3. 모든 게시물은 댓글을 가질 수 있다.
4. 사용자가 한번 글을 보면, 조회수가 1 증가한다.
5. 모든 사용자는 글과 댓글을 쓸 수 있고, 수정삭제가 가능하다.


위의 특성을 읽고 단계별로 데이터베이스 스키마를 정의하고, 간단한 SQL로 게시판을 기획해 보자.


### 오늘의 SQL : 데이터베이스 정의 하기

Constraints 제약조건 : DB를 정의할 때, 해당 컬럼에 조건을 부여해서, 조건에 부합하지 않으면, 에러가 나버리게되어 멈춰버린다.

```
 CREATE TABLE 테이블이름 (
     column datatype constraints
     컬럼명    자료형     제약조건   의 순서대로 들어간다.
     )
```

제약조건에는 여러가지를 중첩해서 넣을 수 있다.

+ NOT NULL : NULL 값 불허용, 이 컬럼이 비어있는 상태로는 존재할 수 없다.
+ UNIQUE : 고유키로 사용, 이 컬럼의 내용은 중복되는 값이 없다.
+ PRIMARY KEY : 기본키로 사용, NOT NULL + UNIQUE 의 특징이라고 생각하면 된다.
+ FOREIGN KEY : 외래키로 사용, 외부에서 가져온 값이다.
+ CHECK (조건) : 조건에 들어가는 내용을 체크한다. 체크했을 때 맞으면 생성,수정을 허용한다.
+ DEFAULT : 초기값으로 사용, NULL의 경우 기본값을 지정하는 것.


제약조건 다음에 AUTO_INCREMENT 를 사용할 수 있다. Integer의 경우에만 사용되는 것으로, 새롭게 데이터가 추가될 때 마다. 자동으로 1 씩 증가하게 할 수 있다. 기본값이 1이고, AUTO_INCREMENT=10 이라고 정의하면, 10씩 증가하게 할 수도 있다. PRIMARY KEY 나 UNIQUE 에 사용하면 굉장히 유용하게 쓸 수 있다.


종합적으로 사용했을 때 예시

```
    CREATE TABLE mihwa(
        pk Integer PRIMARY KEY AUTO_INCREMENT, // PK는 숫자로 자동 증가
        fk Integer FOREING KEY REFERENCES anotherTable(pk) // 다른테이블의 pk 값을 fk로 사용
        name Varchar(20) UNIQUE, // 이름은 겹치지 않는 값이다.
        age Integer CHECK (age >= 18), // 나이가 18세 이상이어야 한다.
        major Varchar(30) DEFAULT '융소' // 전공이 없을 경우 융소로 한다.
        )
```

테이블의 각각 컬럼들에게 조건을 부여함으로써 데이터베이스가 구체적으로 정의해서 목적성을 확실하게 할 수 있고, 관계를 확실히 할 수 있다.


### 데이터의 저장 수정 삭제
저장
```
    INSERT INTO 테이블이름 VALUES ( 값1, 값2, 값3);
    INSERT INTO 테이블이름(컬럼1, 컬럼2, 컬럼3) VALUES (값1, 값2, 값3);
```


수정
```
    UPDATE 테이블이름 SET 컬럼1=값1, 컬럼2=값2, 컬럼3=값3 WHERE 조건;
    조건에 맞는 데이터 수정
```

삭제
```
    DELETE FROM 테이블이름 WHERE 조건;
    조건에 맞는 데이터 삭제
```
